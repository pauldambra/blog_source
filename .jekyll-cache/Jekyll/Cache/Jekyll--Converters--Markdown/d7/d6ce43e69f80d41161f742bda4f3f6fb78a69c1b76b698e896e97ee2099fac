I"(<p>We send out mail to 70,000+ members of our organisation. In theory they know they're getting it cos they're advised when they join the organisation that we'll send the emailâ€¦ yes, I know that implicit opt-ins aren't best practiceâ€¦ I want to polish up our email unsubscribe flow since the amount of mail we send out is steadily climbing as we move from paper to email for more things.</p>

<!--more-->

<p>So first ideaâ€¦ you click a link = you get unsubscribedâ€¦</p>

<p><code class="language-plaintext highlighter-rouge">http://unsubscribe.somewhere.co.uk/123435</code></p>

<p>where 12345 is your user id.</p>

<p>Except someone malicious could</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> for(i=0;i&lt;1000000000;i++)
 {
 	$.get('http://unsubscribe.somewhere.co.uk/'+i);
 }
</code></pre></div></div>
<p>and unsubscribe every member.</p>

<p>No it isn't that likely since this is for a climbing organisation but then you'd be surprised how many smart alec programmers also climb!</p>

<p>Alright we don't need to make it into</p>

<p><code class="language-plaintext highlighter-rouge">http://unsubscribe.somewhere.co.uk/{encrypted_something}</code></p>

<p>I think that would be overkill so let's</p>

<p><code class="language-plaintext highlighter-rouge">http://unsubscribe.somewhere.co.uk/email_address</code></p>

<p>That way although you could sit and guess the email addresses of members to unsubscribe them at least it is harder and the urls are readable</p>

<p>Except the <a href="http://t.co/xH5nYHf">HTTP RFC</a> says that a GET request should be idempotent.</p>

<p><img src="http://1.bp.blogspot.com/-uEF-Zso3K5M/Tju1K8hAhrI/AAAAAAAAAVk/Vi_WggM_FEY/s1600/1095675-futurama_fry_looking_squint_super.jpg" alt="not sure if meme is appropriate or you should feel bad" /></p>

<blockquote>
  <p><a href="http://en.wikipedia.org/wiki/Idempotence">"Idempotence is the property of certain operations in mathematics and computer science, that they can be applied multiple times without changing the result."</a></p>
</blockquote>

<p>In short someone clicking a link can get information from the database but shouldn't update information.</p>

<p>The problem is that I think that is counter-intuitive. I know I don't click links hoping that the actions carried out are idempotent. I click a link <em>expecting</em> something to happen and if we <a href="http://en.wikipedia.org/wiki/Principle_of_least_astonishment">confound a user's expectations </a>then we get to do the same job at least one more timeâ€¦ and I'm lazy - so that isn't a solution for me</p>

<p>But what is the solution since people are not going to want to spend time reading the page. How do I make what someone sees work well?</p>

<p>I'm a google fanboy so <a href="https://mail.google.com/support/bin/answer.py?answer=81126#unsub">what do they say</a></p>

<blockquote>
  <p>Unsubscribing&lt;/span&gt;<br />A user must be able to unsubscribe from your mailing list through one of the following means:</p>

  <p>1) A prominent link in the body of an email leading users to a page confirming his or her unsubscription (no input from the user, other than confirmation, should be required).<br />2) By replying to your email with an unsubscribe request.</p>
</blockquote>

<p>So I think that we're going to shufty this all around a bit.</p>

<p>Two types of mailings = two types of link</p>

<p>unsubscribe.somewhere.co.uk/areas/email@person.com<br />unsubscribe.somewhere.co.uk/monthly/email@person.com</p>

<p>When you hit the page you can click a big button to confirm the action (which ajax-ily updates your displayed state and we can track how many people hit the page without doing anything).</p>

<p><img src="http://4.bp.blogspot.com/-olQbQBRHcak/Tju4pxILv1I/AAAAAAAAAVs/jizlCCsfz1M/s1600/mockup.png" alt="mockup of UI" /></p>
:ET