I"r<p><a href="http://www.tokutek.com/tokumx-for-mongodb/">TokuMX</a> is an</p>

<blockquote>
  <p>"open source, high-performance distribution of MongoDB".</p>
</blockquote>

<p>On a current project we're using MongoDB and, as the system is likely to scale fairly heavily, worrying (primarily) about storage. So, I picked up a task to compare MongoDB and TokuMX.</p>

<!--more-->

<p>My test machine was a MBP with an SSD and 16GB RAM (Hear me roar!). I created a Debian 7 VM using VMware Fusion with 2GB RAM and then cloned it so that I had two identical linux servers.</p>

<p>I installed MongoDB on one and TokuMX on the other.</p>

<p>A NodeJS script was used to repetitively insert 6000 records and then query over the data in a single collection while only one of the two servers was powered on. I didn't clear out the databases between runs although this didn't appear to impact on the results. The script used is available <a href="https://github.com/pauldambra/mongotest">on GitHub</a>and feedback on better tests or mechanism for performing them is welcome!</p>

<p>The tests were run using asynchronous queues with varying levels of concurrency in order to try and simulate a relatively realistic load. The data gathered can be found <a href="http://goo.gl/6a9qfl">on Google Docs</a></p>

<p>The first set of tests were run against a collection with no indexes set.</p>

<h3 id="this-first-test-showed-that-tokumx-query-time-was-much-better-when-searching-on-a-non-indexed-field">This first test showed that TokuMX query time was much better when searching on a non-indexed field.</h3>

<p><img src="http://2.bp.blogspot.com/-VHYm1IS6ML4/UukQH1-OxNI/AAAAAAAAK0w/2TsX0rj48aE/s1600/chart_1.png" alt="Mongo DB vs Toku MX graph" /></p>

<p><img src="http://1.bp.blogspot.com/-Oi1_rzWdpTY/UukQH7w0qmI/AAAAAAAAK0s/nSYB97cQe2c/s1600/chart_2.png" alt="Mongo DB vs Toku MX graph" /></p>

<h3 id="this-performance-difference-larger-disappeared-when-querying-an-indexed-property">This performance difference larger disappeared when querying an indexed property.</h3>

<p><img src="http://3.bp.blogspot.com/-XdZ1UOxNU1M/UukQH1N4B9I/AAAAAAAAK0o/Vq-oyBG2Zwo/s1600/chart_3.png" alt="Mongo DB vs Toku MX graph" /></p>

<p><img src="http://1.bp.blogspot.com/-P5tL71I5HEY/UukQIZtcGYI/AAAAAAAAK1A/889-PAMtc0U/s1600/chart_4.png" alt="Mongo DB vs Toku MX graph" /></p>

<p>TokuMX was still slightly ahead and across all of these datasets was much less affected by the level of concurrency in use.</p>

<p>The real stand out difference here was looking at the amount of storage being used.</p>

<p>After the sets of tests against each server I ran <code class="language-plaintext highlighter-rouge">du -shb /data/db</code> to get the size of the entire database in bytes.</p>

<h3 id="mongodb-was-using-10303-bytes-per-record-stored-and-tokumx-only-104-bytes-per-record-stored">MongoDB was using 10303 bytes per record stored and TokuMX only 104 bytes per record stored.</h3>

<p>These might not be the best measures to use or the best way to gather the data (and I'll gladly try other mechanisms) but on a first glance it appears there is a compelling case to consider using TokuMX over MongoDB</p>
:ET